[global]
    # Server identity
    workgroup = WORKGROUP
    server string = Team 12 Samba Server
    netbios name = TEAM12-SMB
    server role = standalone server

    # Security settings
    security = user
    encrypt passwords = true
    passdb backend = tdbsam
    obey pam restrictions = yes
    unix password sync = yes
    map to guest = never
    guest account = nobody
    
    # Network restrictions
    hosts allow = 127.0.0.1 192.168.12.0/24 172.18.0.0/16
    hosts deny = 0.0.0.0/0
    
    # Protocol settings (enforce modern, secure protocols)
    server min protocol = SMB2
    client min protocol = SMB2
    client max protocol = SMB3
    
    # Disable vulnerable features
    lanman auth = no
    ntlm auth = no
    client ntlmv2 auth = yes
    
    # Logging
    log file = /var/log/samba/log.%m
    max log size = 50
    logging = file
    
    # Additional security measures
    restrict anonymous = 2
    smb encrypt = required
    server signing = required
    client signing = required
    
    # Disable printer sharing (not needed in competition)
    load printers = no
    printing = bsd
    printcap name = /dev/null
    disable spoolss = yes
    
    # Disable browsing (not needed and reduces attack surface)
    local master = no
    domain master = no
    preferred master = no
    os level = 0

[SecureShare]
    comment = Secure Competition Share
    path = /srv/samba/secure
    browseable = yes
    read only = no
    guest ok = no
    valid users = @sambausers
    create mask = 0660
    directory mask = 0770
    force create mode = 0660
    force directory mode = 0770
    hide unreadable = yes
    
    # Additional share-level encryption and signing
    smb encrypt = required
    
    # VFS modules for additional security and logging
    vfs objects = full_audit
    full_audit:prefix = %u|%I|%S
    full_audit:success = mkdir rename unlink rmdir pwrite pread connect disconnect
    full_audit:failure = connect
    full_audit:facility = local5
    full_audit:priority = notice

# Add a read-only documentation share if needed for the competition
[Documentation]
    comment = Competition Documentation
    path = /srv/samba/docs
    browseable = yes
    read only = yes
    guest ok = no
    valid users = @sambausers
    create mask = 0440
    directory mask = 0550
